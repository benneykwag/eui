"use strict";var REDIPS=REDIPS||{};REDIPS.table=(function(){var u,r,e,d,t,o,j,k,b,h,a,f,s,c,l,m,i=[],g,q,p={cell:false,row:false,column:false},n=true;u=function(A,v,z){var B,y,x,w;w=function(F){var C=[],D,E;D=F.getElementsByTagName("table");for(E=0;E<D.length;E++){C.push(D[E])}return C};g=v;if(typeof(A)==="string"){if(z==="classname"){i=w(document);for(y=0;y<i.length;y++){if(i[y].className.indexOf(A)===-1){i.splice(y,1);y--}}}else{A=document.getElementById(A)}}if(A&&typeof(A)==="object"){if(A.nodeName==="TABLE"){i[0]=A}else{i=w(A)}}for(x=0;x<i.length;x++){B=i[x].getElementsByTagName("td");for(y=0;y<B.length;y++){b(B[y])}}l()};b=function(v){if(v.className.indexOf("ignore")>-1){return}if(g===true){REDIPS.event.add(v,"mousedown",r)}else{REDIPS.event.remove(v,"mousedown",r)}};m=function(v){if(typeof(v)==="string"){v=document.getElementById(v)}REDIPS.event.remove(v,"mousedown",r)};r=function(y){var v=y||window.event,z=v.target||v.srcElement,w,x;x=(/^\s*$/.test(z.innerHTML))?true:false;if(REDIPS.table.mark_nonempty===false&&x===false){return}if(v.which){w=v.which}else{w=v.button}if(w===1){z.redips=z.redips||{};if(z.redips.selected===true){k(false,z)}else{k(true,z)}}};e=function(E,D,K){var B,G,F,y,x,v,H,w,I,J,A,z,C={index:-1,span:-1};c();B=(K===undefined)?i:j(K);for(J=0;J<B.length;J++){I=f(B[J]);G=B[J].rows;y=(E==="v")?t(B[J]):G.length;x=(E==="v")?G.length:t(B[J]);for(A=0;A<y;A++){C.index=C.span=-1;for(z=0;z<=x;z++){w=(E==="v")?(z+"-"+A):(A+"-"+z);if(I[w]){F=I[w];F.redips=F.redips||{};v=F?F.redips.selected:false;H=(E==="v")?F.colSpan:F.rowSpan}else{v=false}if(v===true&&C.index===-1){C.index=z;C.span=H}else{if((v!==true&&C.index>-1)||(C.span>-1&&C.span!==H)){d(I,A,C.index,z,E,D);C.index=C.span=-1;if(v===true){if(D===true||D===undefined){k(false,F)}v=false}}}if(I[w]){z+=(E==="v")?F.rowSpan-1:F.colSpan-1}}if(v===true){d(I,A,C.index,z,E,D)}}}l()};d=function(F,E,C,B,z,y){var D=0,v,w,A,x;w=(z==="v")?F[C+"-"+E]:F[E+"-"+C];for(x=C+1;x<B;x++){v=(z==="v")?(x+"-"+E):(E+"-"+x);if(F[v]){A=F[v];D+=(z==="v")?A.rowSpan:A.colSpan;s(A,w);A.parentNode.deleteCell(A.cellIndex)}}if(w!==undefined){if(z==="v"){w.rowSpan+=D}else{w.colSpan+=D}if(y===true||y===undefined){k(false,w)}}};t=function(z){var A=z.rows,y,v=0,x,w;if(typeof(z)==="string"){z=document.getElementById(z)}for(x=0;x<A.length;x++){y=0;for(w=0;w<A[x].cells.length;w++){y+=A[x].cells[w].colSpan||1}if(y>v){v=y}}return v};o=function(A,H){var z,C,B,F,w,v,E,D,G,y,x,I;I=function(O,N,K){var J,M,L;J=0;M=N+O.rowSpan-1;for(L=K-1;L>=0;L--){if(F[M+"-"+L]===undefined){J++}}return J};c();z=(H===undefined)?i:j(H);for(G=0;G<z.length;G++){F=f(z[G]);D=t(z[G]);C=z[G].rows;for(y=0;y<C.length;y++){E=(A==="v")?D:C[y].cells.length;for(x=0;x<E;x++){if(A==="v"){B=F[y+"-"+x];if(B!==undefined){B.redips=B.redips||{}}if(B!==undefined&&B.redips.selected===true&&B.rowSpan>1){w=I(B,y,x);v=C[y+B.rowSpan-1].insertCell(x-w);v.colSpan=B.colSpan;B.rowSpan-=1;b(v);F=f(z[G])}}else{B=C[y].cells[x];B.redips=B.redips||{};if(B.redips.selected===true&&B.colSpan>1){E++;v=C[y].insertCell(x+1);v.rowSpan=B.rowSpan;B.colSpan-=1;b(v)}}if(B!==undefined){k(false,B)}}}}l()};j=function(v){var w=[];if(v!==undefined){if(typeof(v)==="string"){v=document.getElementById(v)}if(v&&typeof(v)==="object"&&v.nodeName==="TABLE"){w[0]=v}}return w};h=function(G,z,A){var y,E=null,B,C,F,D=0,x,w,v;c();if(typeof(G)!=="object"){G=document.getElementById(G)}if(A===undefined){A=-1}if(z==="insert"){B=G.rows[0];for(x=0;x<B.cells.length;x++){D+=B.cells[x].colSpan}E=G.insertRow(A);for(x=0;x<D;x++){y=E.insertCell(x);b(y)}l()}else{if(G.rows.length===1){return}G.deleteRow(A);F=f(G);A=G.rows.length-1;D=t(G);for(x=0;x<D;x++){C=F[A+"-"+x];if(C===undefined){for(w=A,v=1;w>=0;w--,v++){C=F[w+"-"+x];if(C!==undefined){C.rowSpan=v;break}}}else{if(C.rowSpan>1){C.rowSpan-=1}}x+=C.colSpan-1}}return E};a=function(y,z,w){var B,v,A,x;c();if(typeof(y)!=="object"){y=document.getElementById(y)}if(w===undefined){w=-1}if(z==="insert"){for(x=0;x<y.rows.length;x++){A=y.rows[x].insertCell(w);b(A)}l()}else{B=y.rows[0].cells;if(B.length===1&&(B[0].colSpan===1||B[0].colSpan===undefined)){return}for(x=0;x<y.rows.length;x++){if(w===-1){v=y.rows[x].cells.length-1}else{v=w}B=y.rows[x].cells[v];if(B.colSpan>1){B.colSpan-=1}else{y.rows[x].deleteCell(w)}x+=B.rowSpan-1}}};k=function(w,y,z,x){var v;if(typeof(w)!=="boolean"){return}if(typeof(y)==="string"){y=document.getElementById(y)}else{if(typeof(y)!=="object"){return}}if(y.nodeName==="TABLE"){v=f(y);y=v[z+"-"+x]}if(!y||y.nodeName!=="TD"){return}y.redips=y.redips||{};if(typeof(REDIPS.table.color.cell)==="string"){if(w===true){y.redips.background_old=y.style.backgroundColor;y.style.backgroundColor=REDIPS.table.color.cell}else{y.style.backgroundColor=y.redips.background_old}}y.redips.selected=w};c=function(){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection&&document.selection.type==="Text"){try{document.selection.empty()}catch(v){}}}};f=function(I){var G=[],v,x={},F,H,A,w,E,D,C,B,z,y;D=I.rows;for(C=0;C<D.length;C++){for(B=0;B<D[C].cells.length;B++){F=D[C].cells[B];H=F.parentNode.rowIndex;A=F.rowSpan||1;w=F.colSpan||1;G[H]=G[H]||[];for(z=0;z<G[H].length+1;z++){if(typeof(G[H][z])==="undefined"){E=z;break}}x[H+"-"+E]=F;for(z=H;z<H+A;z++){G[z]=G[z]||[];v=G[z];for(y=E;y<E+w;y++){v[y]="x"}}}}return x};s=function(z,y){var x,w,v;if(z===y){return}x=z.childNodes.length;for(w=0,v=0;w<x;w++){if(z.childNodes[v].nodeType===1){y.appendChild(z.childNodes[v])}else{v++}}};l=function(w){if(w===undefined&&q!==true){return}if(w!==undefined){q=w}var A,C,v,B,z,x,y;for(y=0;y<i.length;y++){A=i[y].rows;B=t(i[y]);v=f(i[y]);for(z=0;z<A.length;z++){for(x=0;x<B;x++){if(v[z+"-"+x]){C=v[z+"-"+x];C.innerHTML=(q)?z+"-"+x:""}}}}};return{color:p,mark_nonempty:n,onmousedown:u,mark:k,merge:e,split:o,row:h,column:a,cell_index:l,cell_ignore:m}}());if(!REDIPS.event){REDIPS.event=(function(){var b,a;b=function(e,c,d){if(e.addEventListener){e.addEventListener(c,d,false)}else{if(e.attachEvent){e.attachEvent("on"+c,d)}else{e["on"+c]=d}}};a=function(e,c,d){if(e.removeEventListener){e.removeEventListener(c,d,false)}else{if(e.detachEvent){e.detachEvent("on"+c,d)}else{e["on"+c]=null}}};return{add:b,remove:a}}())};